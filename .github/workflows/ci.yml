name: CI

# Controls when the action will run.
# For various triggers, see the common "on" clauses: https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel.
# For more information, see: https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions

jobs:
  # This job builds the code, tests it, and deploys it if necessary.
  build-and-test:
    # The type of runner that the job will run on.
    # For a list of available runners, see: https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idruns-on
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [ '20' ] # Assuming Node.js is used for build/frontend

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm' # Cache npm dependencies

      - name: Install Dependencies
        run: npm ci # Use npm ci for faster, more reliable installs in CI

      - name: Lint with Ruff
        # Assuming Ruff is configured for frontend linting (e.g., ESLint equivalent)
        run: npx ruff check .

      - name: Format with Ruff
        # Assuming Ruff is configured for formatting
        run: npx ruff format .

      - name: Build Frontend (Vite)
        # This step assumes Vite is used for building the frontend assets
        run: npm run build
        env:
          NODE_ENV: production

      # Add E2E testing if applicable (e.g., Playwright)
      # - name: Setup Playwright
      #   uses: playwright-github-action/setup-playwright@v1
      #
      # - name: Run End-to-End Tests
      #   run: npm run test:e2e
      #   env:
      #     NODE_ENV: test

      # Add deployment step here if needed
      # - name: Deploy to Production
      #   if: github.ref == 'refs/heads/main' && github.event_name == 'push'
      #   run: echo "Deploying to production..."
